# 智能合约虚拟机对比 EVM WASM 性能安全
智能合约虚拟机 (VM) 的对比主要集中在以太坊虚拟机 (EVM)、WebAssembly (WASM)、HVM 和 MOVE 这几种虚拟机上，比较维度通常包括性能和安全性。

EVM:

*   基础概念: EVM 是以太坊的心脏，类似于 Java 虚拟机之于 Java 语言<sup>1</sup>。它将 Solidity 等高级语言编写的合约代码编译成以太坊可以识别的机器码并在以太坊环境中运行<sup>1</sup>。
*   运作方式: EVM 是一个基于堆栈的虚拟机，具有临时内存字节数组和持久键值存储<sup>1</sup>。交易在 EVM 中会转换成一个 Message 对象，如果是智能合约的创建或调用，则通过 EVM 中的解释器加载和执行字节码，执行过程中可能会查询或者修改 StateDB<sup>1</sup>。
*   特点: EVM 提供了一个安全的环境来运行智能合约，隔离合约代码，防止恶意代码或编程错误影响主链<sup>1</sup>。 大部分主流公链都兼容EVM， 方便开发者将以太坊的智能合约无缝迁移到其他链上<sup>1</sup>。
*   局限: EVM 处理 256 位字节码，小于 256 位的字节码需要先转换为 256 位格式才能被 EVM 处理<sup>2</sup>。EVM 的可扩展性有限，每秒只能处理少量交易<sup>2</sup>。EVM 为了强调正确性而非效率而设计<sup>2</sup>。

WASM:

*   基础概念: WASM 是一个基于二进制操作指令的栈式结构的虚拟机，可以编译为机器码，从而实现快速、高效地执行<sup>1</sup>。
*   优势: WASM 虚拟机已被 Google、Facebook、Microsoft 等公司支持，可在流行的浏览器中运行<sup>1</sup>。WASM 具有快速、高效、可移植、可读、可调试和安全的特性<sup>1</sup>。WASM 可以直接转换为编译后的代码，加载速度更快，并能增加每个区块所处理的交易数量<sup>2</sup>。
*   与 EVM 的对比: WASM 支持更多的语言，并提供比 EVM 更广泛的工具集<sup>1</sup>。WASM 消除了以太坊对预编译合约的依赖，开发者可以创建高效、快速的智能合约，而无需担心潜在的硬分叉<sup>1</sup>。
*   应用: 不仅可以嵌入浏览器增强 web 应用，也可以应用于其他的场景。波卡（Polkadot）、Cardano、EOS、Tron、Spacemesh 和 NEAR 协议等项目已经或正在采用 WASM<sup>2</sup>。

HVM:

*   基础概念: HVM 是趣链科技首创的支持 Java 语言的智能合约执行引擎<sup>1</sup>。
*   特点: HVM 支持符合 Java 编写规范的多种数据结构，内置数据表结构，可以实现业务数据可视化<sup>1</sup>。HVM 提供多级日志、分层调用模式和加解密工具，并支持合约访问控制<sup>1</sup>。HVM 通过定制类加载器、类加载缓存、指令解析等方式来提高执行效率<sup>1</sup>。

MOVE:

*   基础概念: MoveVM 是具有静态类型系统的堆栈机<sup>1</sup>。
*   特点: Move 语言的设计强调安全性，旨在避免重入漏洞、毒令牌和欺骗性令牌批准等问题<sup>1</sup>。Move 与平台无关，支持跨区块链的共享库、工具和开发者社区<sup>1</sup>。

总的来说，WASM 在性能上优于 EVM，并且支持更多的编程语言。HVM 则主要在 Java 语言智能合约方面有优势，而 MOVE 语言则侧重于安全性。选择哪种虚拟机取决于具体的应用场景和需求。

References:
[1] 了解区块链虚拟机：EVM、HVM、WASM、MOVE - https://zhuanlan.zhihu.com/p/596991126
[2] 波卡的Wasm和以太坊2.0的eWasm相对于EVM虚拟机的绝对优势 - https://juejin.cn/post/6948298710849683470
